## Слой Application

Слой **Application** отвечает за реализацию бизнес-логики приложения. В этом слое находятся компоненты, управляющие процессами, связанными с расчетами, проверкой данных и другими ключевыми операциями.

### Основные компоненты слоя Application

1. **Контракты (Contracts)**
    - Контракты определяют интерфейсы, которые задают структуру взаимодействия между компонентами приложения.
    - Примеры:
        - Интерфейсы для сервисов (`IProductService`, `IPaymentService`).
        - Интерфейсы для репозиториев (`IProductRepository`, `IPurchaseRepository`).
    - **Преимущества:**
        - Четкая структура взаимодействия.
        - Упрощенное внедрение зависимостей.

2. **DTO (Data Transfer Objects)**
    - Объекты передачи данных используются для обмена данными между слоями приложения.
    - Примеры DTO:
        - `ProductUpdateInfo`: для обновления информации о продукте.
        - `InstallmentRequest`: для передачи данных о запросе рассрочки.
        - `InstallmentResponse`: для передачи рассчитанной информации о рассрочке.
    - **Назначение:**
        - Изоляция внутренних сущностей от внешнего взаимодействия.

3. **Мапперы (Mappers)**
    - Мапперы преобразуют данные из одной модели в другую (например, DTO в сущности и обратно).
    - Пример:
        - `InstallmentMapper`: преобразует `InstallmentRequest` в сущность слоя **Domain**.

4. **Логика рассрочки**
    - Реализация ключевой бизнес-логики, связанной с расчетами рассрочки:
        - Проверка диапазона рассрочки в зависимости от категории товара.
        - Расчет дополнительной процентной ставки на основе срока рассрочки.
    - Пример задачи:
        - Если категория — "Смартфон", срок — 6 месяцев:
            1. Проверить, входит ли 6 в диапазон `[3-9]`.
            2. Рассчитать дополнительный процент: `(6 - 3) * 3%`.

5. **Фильтры и пагинация**
    - Реализация логики фильтрации и пагинации для работы с большими объемами данных.
    - Пример:
        - Метод `ApplyPagination` возвращает записи на основе номера страницы и размера страницы.

6. **Результаты операций (Result)**
    - Используется паттерн "Result" для обработки результатов операций.
        - `BaseResult`: базовый класс для успешных и неуспешных результатов.
        - `Result<T>`: результат с данными (например, расчеты рассрочки).
    - **Преимущества:**
        - Централизованное управление ошибками.
        - Единый формат успешных и неуспешных ответов.

7. **Пример обработки рассрочки**
    - Процесс:
        1. Проверка входных данных.
        2. Валидация срока рассрочки на основе категории товара.
        3. Расчет общей суммы платежа.
        4. Формирование ответа (DTO) с деталями рассрочки.
    - Пример:
        - Клиент отправляет запрос: **Смартфон**, сумма **1000**, срок **6 месяцев**.
        - Приложение:
            1. Проверяет валидность срока.
            2. Рассчитывает сумму: `1000 + 9% = 1090`.
            3. Возвращает результат клиенту.